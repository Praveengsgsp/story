chapter 3 with few more changes